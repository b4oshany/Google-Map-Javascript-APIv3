<!DOCTYPE html>
<html data-cloud9-id='1'>
  <head data-cloud9-id='2'>
    <meta data-cloud9-id='5' name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta data-cloud9-id='6' charset="utf-8">
    <title data-cloud9-id='7'>Simple markers</title>
    <style data-cloud9-id='8'>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #map-holder{
        width: 70%;
        height: 100%;
        float: left;
      }
      #side{
        width: 20%;
        height: 100%;
        padding: 10px;
        display: inline-block;
      }
      #side:after{
        content: '';
        clear: both;
        display: block;
      }
    </style>
    </head>
<body data-cloud9-id='3'>
<div data-cloud9-id='9' id="map-holder">
    <div data-cloud9-id='10' id="map-canvas"></div>
</div>
<div data-cloud9-id='11' id="side" style="width: 28%; display: inline-block">
    <p data-cloud9-id='12'>Press tab to search or Remove focus off the input</p>
    search: <input data-cloud9-id='13' type="text" id="address" value="Jamaica" onblur="searchfor(this.value)" />
    <p data-cloud9-id='14'>lat: <label data-cloud9-id='15' id="lat"></label></p>
    <p data-cloud9-id='16'>long: <label data-cloud9-id='17' id="long"></label></p>
</div>
<script data-cloud9-id='18' src="gmap.js"></script>
<script data-cloud9-id='19'>
var uwi = {lat: 18.0030, lng: -76.7446};
var pyr = GMaps.createCords(-33.8665433,151.1956316);
var sydney = GMaps.createCords(-33.866647, 151.195886);
var gmap = null;

function searchfor(text){
    // Allow the first added marker to be in the center of map.
    gmap.settings.placeCenter = true;
    // Limit the result to one.
    gmap.settings.limitResults = 1;
    // Perform a search query based on the address string.
    // In addition, override the default callback function by supplying a function as the
    // the second argument. This function takes in the results of the search and the status.
    gmap.textSearch(text, function(results, status){
        // Use the actually default callback function to filter places but override the
        // creation of markers by supply a function as the third argument in the mapQueryResult function. This function
        // takes in the current indexed place and the index number within the filter process.
        gmap.mapQueryResult(results, status, function(place, index){
            // Note. We don't have to manage the result status since it is already been taken care of by the mapQueryResult function.
            // Now that we are in the filtering process of places, we can create markers or do anything we like.
            // In this case, I'm adding additional options (i.e. allow the marker to be draggable)
            // to the marker.
            gmap.createMarker(
                GMaps.formatQueryResult(place),
                place.geometry.location,
                { draggable: true },
                function(marker){
                    // Adding event handlers to a marker.
                    GMaps.addListener(marker, "dragend", function(e){
                        var position = this.getPosition();
                        document.querySelector("#lat").innerHTML = position.k;
                        document.querySelector("#long").innerHTML = position.D;
                    });
                }
            );
        });
    });
}

function mapInitializer(){
    // Create a map object by passing the canvas id of the map.
    gmap = new GMaps('map-canvas');
    // Initiate the map.
    gmap.render();
    // Disable the displaying of places nearby.
    gmap.settings.showPlacesNearby = false;
    
    // Get the property address string.
    var address = document.querySelector("#address").value;
    searchfor(address);
};

GMaps.initialize({"v": "3.exp", "region": "JAM", "callback":"mapInitializer", "signed_in": true, "libraries": "places"});
</script>
</body>
<html data-cloud9-id='1'>
<script src="/_static/preview/livecss.js"></script>